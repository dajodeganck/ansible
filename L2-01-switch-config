---
- name: Apply basic configuration to Cisco switch
  hosts: switches
  gather_facts: no
  tasks:
    - name: Remove existing MOTD banner
      cisco.ios.ios_banner:
        banner: motd
        state: absent

    - name: Configure the login banner
      cisco.ios.ios_banner:
        banner: motd
        text: |
          Unauthorized access to this device is prohibited!
        state: present

    - name: Disable IP domain lookup
      cisco.ios.ios_config:
        lines:
          - no ip domain-lookup

    - name: Set hostname
      cisco.ios.ios_config:
        lines:
          - hostname SW_L2_1

    - name: Remove existing VLAN configurations
      cisco.ios.ios_config:
        lines:
          - no vlan 10
        save_when: modified

    - name: Configure VLAN 10
      cisco.ios.ios_config:
        lines:
          - vlan 10
          - name Users

    - name: Default interface VLAN 1
      cisco.ios.ios_config:
        lines:
          - default interface vlan 1

    - name: Configure interface VLAN 1
      cisco.ios.ios_config:
        lines:
          - interface vlan 1
          - description "Default VLAN"
          - ip address 10.10.10.21 255.255.254.0
          - no shutdown

    - name: Default interface VLAN 10
      cisco.ios.ios_config:
        lines:
          - default interface vlan 10

    - name: Configure interface VLAN 10
      cisco.ios.ios_config:
        lines:
          - interface vlan 10
          - description Users
          - no shutdown

    - name: Remove existing console and VTY configurations
      cisco.ios.ios_config:
        lines:
          - no line console 0
          - no line vty 0 4

    - name: Configure console line
      cisco.ios.ios_config:
        lines:
          - line console 0
          - password cisco
          - login

    - name: Configure transport and login settings for VTY lines
      cisco.ios.ios_config:
        lines:
          - line vty 0 4
          - transport input ssh
          - login local

    - name: Save configuration
      cisco.ios.ios_command:
        commands:
          - write memory
